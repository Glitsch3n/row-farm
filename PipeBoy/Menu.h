
#include "Constants.h"

class GameManager;

enum class MenuSelection : uint8_t {
  Play = 0,
  Sound,
  Score
};
constexpr uint8_t NB_OPTIONS = 3;

enum class MenuSelectionPlay : uint8_t{
  OnePlayer = 0,
  TwoPlayers,
  Password,
};
constexpr uint8_t NB_OPTIONS_PLAY = 3;

enum class MenuType : uint8_t {
  MenuSelection = 0,
  MenuSelectionPlay,
};

constexpr uint8_t MENU_POSITION_X = 30;
constexpr uint8_t MENU_POSITION_Y = 33;

constexpr uint8_t NB_WATER_DROP = 2;
constexpr uint8_t WATER_DROP_MIN_COUNTDOWN = 20;
constexpr uint8_t WATER_DROP_MAX_COUNTDOWN = 30;
constexpr uint8_t WATER_DROP_INITIAL_X = 18;
constexpr uint8_t WATER_DROP_2_INITIAL_X = 108;
constexpr uint8_t WATER_DROP_INITIAL_Y = 28;
constexpr uint8_t WATER_DROP_COUNTDOWN = 40;


class Menu {
private:
    uint8_t selectedOption = 0;
    MenuType menuType = MenuType::MenuSelection;

    const char *options[2][3] = {
        {"Play", "Sound: ", "Score"},
        {"1 Player", "2 Players", "Password"}
    };

    union WaterDrop {
        struct {
            uint8_t y : 7;
            uint8_t velocity : 3;
            uint8_t counter : 6;
        };
        uint16_t raw;
    } waterDrops[NB_WATER_DROP];

  uint8_t getNbMaxOptions() const;

public:
    Menu();

    void render(GameManager *gm) const;
    void update(GameManager *gm);
    void reset();
};

const uint8_t PROGMEM titlescreen[] = {
0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0xaa, 0x55, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x08, 0x08, 0xf8, 0xf8, 0x08, 0x08, 0x08, 0x08, 0x18, 0xf0, 0xe0, 0x40, 0x40, 0xd8, 0xd8, 0x00, 0x00, 0x40, 0x40, 0xc0, 0xc0, 0x80, 0x40, 0x40, 0x40, 0xc0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x40, 0x40, 0x40, 0xc0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x08, 0x08, 0xf8, 0xf8, 0x08, 0x08, 0x08, 0x08, 0x98, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x80, 0xc0, 0x40, 0x40, 0x40, 0xc0, 0x80, 0x00, 0x00, 0x40, 0x40, 0xc0, 0xc0, 0x40, 0x40, 0x00, 0x00, 0x40, 0xc0, 0xc0, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x55, 0xaa, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0xaa, 0x55, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0xff, 0xff, 0x82, 0x82, 0x82, 0x02, 0x03, 0x01, 0x00, 0x80, 0x80, 0xff, 0xff, 0x80, 0x80, 0x00, 0x00, 0xff, 0xff, 0x40, 0x80, 0x80, 0x80, 0xc0, 0x7f, 0x1f, 0x00, 0x00, 0x3e, 0x7f, 0xe4, 0x84, 0x84, 0x84, 0x84, 0x67, 0x37, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0xff, 0xff, 0x81, 0x81, 0x81, 0x81, 0xc3, 0x7e, 0x3c, 0x00, 0x00, 0x1e, 0x7f, 0xc0, 0x80, 0x80, 0x80, 0xc0, 0x7f, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x07, 0x1f, 0xf8, 0xc0, 0xe0, 0x3c, 0x0f, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x55, 0xaa, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0xaa, 0x55, 0xff, 0x40, 0xc0, 0x40, 0xe0, 0x50, 0x30, 0x50, 0x30, 0x50, 0xe0, 0x50, 0x30, 0x50, 0x30, 0x50, 0xa0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc8, 0x4c, 0xc7, 0x47, 0xcc, 0x48, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x40, 0xc0, 0x47, 0xcf, 0x48, 0xc8, 0x4c, 0xc6, 0x43, 0xc0, 0x40, 0xa0, 0x50, 0x30, 0x50, 0x30, 0x50, 0xe0, 0x50, 0x30, 0x50, 0x30, 0x50, 0xe0, 0x40, 0xc0, 0x40, 0xff, 0x55, 0xaa, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x07, 0x08, 0x08, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x18, 0x20, 0x20, 0x20, 0x20, 0x20, 0x1f, 0x20, 0x20, 0x20, 0x20, 0x20, 0x10, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x09, 0x10, 0x20, 0x20, 0x20, 0x20, 0x20, 0x1f, 0x20, 0x20, 0x20, 0x20, 0x20, 0x18, 0x09, 0x08, 0x09, 0x08, 0x09, 0x08, 0x08, 0x08, 0x07, 0x00, 0x00, 0x00, 0x00, 
};

